V-4.0

This version of the code is a reworked version of 3.4
Code has been tidied


ONLINE TESTED!